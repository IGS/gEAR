<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Gene cart manager</title>
        <meta http-equiv="Pragma" content="no-cache">
        <meta http-equiv="Expires" content="-1">
        <meta http-equiv="CACHE-CONTROL" content="NO-CACHE">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous" />
        <link rel="stylesheet" href="css/vendor/bootstrap-editable.css" />
        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.4.0/css/bootstrap4-toggle.min.css"/>

        <!--
        <link rel="stylesheet" href="css/jquery.fileupload.css" />
        <link rel="stylesheet" href="css/vendor/bootstrap-tokenfield.css">
		<link rel="stylesheet" href="css/vendor/tokenfield-typeahead.css">
        -->
        <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet" /> -->

        <!-- Ensures we always get a new version (during our current active development cycles) -->
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
        <script>document.write('<link rel="stylesheet" href="css/common.css?dev=' + Math.floor(Math.random() * 10000) + '"\><\/link>');</script>
        <script>document.write('<link rel="stylesheet" href="css/gene_cart_manager.css?dev=' + Math.floor(Math.random() * 10000) + '"\><\/link>');</script>

        <script src="js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
    </head>
    <body>

        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
 <div id="body_c">
    <div id="navigation_bar">
      <!-- content here inserted via JQuery -->
    </div> <!-- end navigation_bar -->
    <div>
      <div class="alert-container">
	      <!-- CONTAINER FOR ALERTS - INSERTED BY JQUERY -->
      </div>
    </div>
    <div id="login_checking">
      <div>
        <h2><img id="checking_indicator" src="img/loading_search.gif" alt="checking">Checking login status</h2>
      </div>
    </div>
    <div id="login_warning">
      <div>
        <h2>Login required</h2>
        <p>
          You must be logged in to manage and create gene carts.  Please use the login form in the top-right.
        </p>
      </div>
    </div>

    <div id="main_content" class="container-fluid">
      <div class="row">
        <div id="page_name" class="col-12">
          <h2>Gene cart manager</h2>
        </div>
      </div>

      <div id='main_row' class="row">
        <div id="controls" class="col-2">
          <div id='controls_primary_search'>
            <form id="submit_search">
              <div class="form-group">
                <label for="search" class="form-label-sm mb-0">Find carts:</label>
                <div class="btn-group">
                  <input type="search" class="form-control form-control-sm" placeholder="Enter search terms" id="search_terms">
                  <span id="search_clear" class="fa fa-times-circle shown_later"></span>
                </div>
              </div>
            </form>
          </div> <!-- #controls_primary_search -->
          
          <div id='add_cart_controls_c'>
            <button type="button" id="btn_create_cart_toggle" class="btn btn-sm btn-primary">Create new cart</button>
          </div>

          <div id='controls_ownership' class='filter_subsection'>
            <h4 class="expandable_control"><i class="fa fa-plus shown_later"></i><i class="fa fa-minus"></i> Ownership</h4>
            <ul class="controls_filter_options expandable_target">
              <li class="all_selector">All</li>
              <li id="your_gene_cart_filter" data-dbval="yours">Your carts</li>
              <!--<li data-dbval="shared">Shared with you</li>-->
              <li data-dbval="public">Public carts</li>
            </ul>
          </div>
          <div id="controls_organism" class="filter_subsection">
            <h4 class="expandable_control"><i class="fa fa-plus shown_later"></i><i class="fa fa-minus"></i> Organism</h4>
            <ul id="organism_choices" class="controls_filter_options expandable_target">
              <li class="all_selector selected">All</li>
            </ul>
            <script id="organism_list_tmpl" type="text/x-jsrender">
              <li data-dbval="{{:id}}">{{:label}}</li>
            </script>
          </div>
          <div id='controls_date_added' class='filter_subsection'>
            <h4 class="expandable_control"><i class="fa fa-plus shown_later"></i><i class="fa fa-minus"></i> Date added</h4>
            <ul class="controls_filter_options expandable_target only_one">
              <li class="all_selector selected">Any time</li>
              <li data-dbval="week">Within last week</li>
              <li data-dbval="month">Within last month</li>
              <li data-dbval="year">Within last year</li>
            </ul>
          </div>
        </div> <!-- #controls -->
        <div id="main_panel" class="col-sm-10">
          <div id="initial_instructions_c" class="row ml-4 mr-4 mb-3 pt-2 pb-2">
            <div class="col-sm-12">
              <div id="initial_instructions_header" class="row">
                <div id="initial_instructions_bar" class="col-sm-11">
                  Click for instructions
                  
                </div>
                <div id="initial_instructions_closer" class="col-sm-1 pt-1">
                  <i class="fa fa-window-close pull-right"></i>
                </div>
              </div><!-- end initial_instructions_header -->
              <div id="initial_instructions_body" class="row">
                <div class="col-sm-12">
                  <p>
                    The column on the left is to help you find gene carts either you have made
                    or others have made visible to you.  You can search via keywords or use
                    the faceted search options to get results like "Show me all gene carts
                    for mouse added in the last month." 
                  </p>
                  <p>
                    You can also click the "Create new cart" button to make a new cart of
                    your own.  This will open instructions and descriptions of the three
                    different cart upload types/methods.
                  </p>
                </div>
              </div>
            </div> 
          </div> <!-- end initial_instructions_c -->
          <div id="add_cart_panel" class="row shown_later">
            <div class="col-sm-12">
              <div class="row">
                <div class="col-sm-12">
                  <div class="card-deck">
                    <div class="card">
                      <div class="card-header" id="new_cart_unweighted_header">
                        Unweighted
                      </div>
                      <div class="card-body">
                        <h5 class="card-title">Create unweighted gene cart</h5>
                        <p class="card-text">
                          This is a list of gene symbols only, possibly the most common form of gene carts.
                        </p>
                        <button class="btn btn-sm btn-primary" id="btn_gc_paste_unweighted_list">Paste gene list</button>
                        <button class="btn btn-sm btn-primary" id="btn_gc_upload_unweighted_list">Upload gene list</button>
                      </div>
                    </div>
                    <div class="card">
                      <div class="card-header" id="new_cart_weighted_header">
                        Weighted
                      </div>
                      <div class="card-body">
                        <h5 class="card-title">Create weighted gene cart</h5>
                        <p class="card-text">
                          Upload a gene list with associated weights, for example from a principal component analysis
                        </p>
                        <button class="btn btn-sm btn-primary" id="btn_gc_upload_weighted_list">Upload weighted list file</button>
                      </div>
                    </div>
                  </div><!-- end .card-deck -->
                </div>
              </div>
              <div class="row shown_later" id="new_cart_form_c">
                <div class="col-sm-12">
                  <div class="card-deck mt-3">
                    <div class="card">
                      <div class="card-header">New gene cart information</div>
                      <div class="card-body">
                        <form id="new_cart_data">
                          <input type="hidden" id="new_cart_upload_type" name="new_cart_upload_type" value="" />
                          <div class="row">
                            <div class="col-5">
                               <div class="form-group">
                                 <label for="new_cart_label">Label</label>
                                 <input type="text" class="form-control" id="new_cart_label" name="new_cart_label" placeholder="" />
                               </div>
                            </div>
                            <div class="col-4">
                              <div class="form-group">
                                <label for="new_cart_organism_id">Organism</label>
                                <select class="form-control" id="new_cart_organism_id" name="new_cart_organism_id"></select>
                                <script id="organism_select_tmpl" type="text/x-jsrender">
                                  <option value="{{:id}}">{{:label}}</option>
                                 </script>
                              </div>
                            </div>
                            <div class="col-3">
                               <div class="form-group">
                                 <label for="new_cart_is_public">Visibility</label><br />
                                 <input type="checkbox" name="new_cart_is_public" id="new_cart_is_public" data-size="small" data-offstyle="danger" data-width="100" data-toggle="toggle" data-on="Public" data-off="Private" />
                               </div>
                            </div>
                          </div>
                          <div class="form-group">
                            <label for="new_cart_ldesc">Longer description</label>
                            <textarea class="form-control" id="new_cart_ldesc" name="new_cart_ldesc" rows="3"></textarea>
                          </div>
                          <div id="file_upload_c" class="form-group">
                            <label for="new_cart_file">File upload</label>
                            <input class="pl-3 pr-3" name="new_cart_file" type="file" id="new_cart_file"/>
                          </div>
                          <div class="form-group shown_later" id="new_cart_pasted_genes_c">
                            <label for="new_cart_pasted_genes">Paste gene symbols, separated by commas, spaces or on separate lines</label>
                            <textarea class="form-control" id="new_cart_pasted_genes" name="new_cart_pasted_genes" rows="3" placeholder="Example: Sox2 Pou4f3 Rfx7"></textarea>
                          </div>
                        </form>
                        <button class="btn btn-sm btn-primary" id="btn_new_cart_save">Save</button>
                        <button class="btn btn-sm btn-primary shown_later" id="btn_new_cart_saving" type="button" disabled>
                          <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                          Save
                        </button>
                        <button class="btn btn-sm btn-primary" id="btn_new_cart_cancel">Cancel</button>
                      </div>
                    </div>
                  </div> <!-- end .card-deck -->
                </div>
              </div>
            </div>
          </div><!-- end #add_cart_panel -->
          <div id="view_controls" class="row">
            <!-- Count and view control -->
            <div class="col-sm-5">
              <div class="row">
                <div id="gc_count_label_c" class="col-sm-7">
                  <span id="gc_count_label"><span id="result_count"></span> <span id="result_label"></span></span>
                </div>
                <div class="col-sm-5">
                  <span class="label_by_buttons">View: </span>
                  <div class="btn-group" role="group" aria-label="Gene cart list view preference">
                    <button type="button" id="btn_list_view_compact" class="btn btn-secondary btn-sm active" aria-label="Compact view" data-toggle="popover" data-toggle="tooltip" data-placement="top" title="Compact view"><i class="fa fa-list"></i></button>
                    <button type="button" id="btn_list_view_expanded" class="btn btn-secondary btn-sm" aria-label="Expanded view" data-toggle="popover" data-toggle="tooltip" data-placement="top" title="Expanded view"><i class="fa fa-window-maximize"></i></button>
                  </div>
                </div>
              </div>
            </div>
            <!-- Sorting controls -->
            <div id="sort_controls" class="col-sm-3">
              <div class="form-group">
                <label class="d-inline-block" for="sort_by">Sort by:</label>
                <select name="sort_by" class="form-control form-control-sm d-inline-block" style="width: auto;" id="sort_by">
                   <option value="relevance">Relevance</option>
                   <option value="title">Gene cart title</option>
                   <option value="date_added" selected>Date created</option>
                   <option value="owner">Owner</option>
                </select>
              </div>
            </div><!-- #sort_controls -->
            <!-- Pagination -->
            <div id="pagination_controls" class="col-sm-4">
                <!--
                <span class="label_by_buttons">Page:</span>
                <div class="btn-group mr-3" role="group">
                  <button type="button" class="btn btn-sm btn-secondary">1</button>
                  <button type="button" class="btn btn-sm btn-secondary">2</button>
                  <button type="button" class="btn btn-sm btn-secondary">3</button>
                  <button type="button" class="btn btn-sm btn-secondary">4</button>
                </div>
                <div class="btn-group" role="group">
                  <button type="button" class="btn btn-sm btn-secondary">Show all</button>
                </div>
                -->
            </div> <!-- #pagination_controls -->
          </div> <!-- #view_controls -->
          <!--
              In this section of looped gene gart displays there are class-based controls for editable fields.
              This is controlled by a few paired classes, "is-editable" and "editable-version".  When the
              user clicks the edit button for any dataset all the elements which are is-editable are hidden
              and the editable-version ones are displayed in their stead.
          -->
          <div id="gc_viewport" class="row">`
            <div id="gc_list_c" class="col-sm-12">
              <div id="gc_list_results_view_c"></div>
              <script id="gc_results_view_tmpl" type="text/x-jsrender">
                 <div class="gc_list_element_c row" id="result_gc_id_{{:id}}" data-gc-id="{{:id}}">
                   <div class="col-sm-12">
                     <div class="row">
                       <div class="col-sm-11 is-editable">
                         <h5 id="result_gc_id_{{:id}}_display_title">{{:label}}</h5>
                       </div>
                       <div id="editable_title_c" class="col-sm-11 editable-version">
                         <div class="form-group">
                           <span class="att_label">Title</span>
                           <input type="text" class="form-control form-control-sm editable_title" id="result_gc_id_{{:id}}_editable_title" data-original-val="{{:label}}" value="{{:label}}"/>
                        </div>
                      </div>
                       <div class="col-sm-1">
                         <!--<span class="gc-expander pull-right" data-gc-id="{{:id}}"><i class="fa fa-expand"></i></span>-->
                       </div>
                     </div>
                     <div class="row no-gutters">
                       <div class="col-sm-3 pl-2 is-editable">
                         {{if is_public == 1}}
                         <span id="result_gc_id_{{:id}}_display_visibility" class="badge badge-light">Public gene cart</span>
                         {{else}}
                         <span id="result_gc_id_{{:id}}_display_visibility" class="badge badge-danger">Private gene cart</span>
                         {{/if}}
                       </div>
                       <div class="col-sm-3 pl-2 editable-version">
                         <div class="form-group">
                           <label for="result_gc_id_{{:id}}_editable_visibility">Visibility</label><br />
                           <input type="checkbox" name="result_gc_id_{{:id}}_editable_visibility" id="result_gc_id_{{:id}}_editable_visibility"
                                  data-is-public="{{:is_public}}" data-size="small" data-offstyle="danger" data-width="100" data-toggle="toggle"
                                  data-on="Public" data-off="Private" />
                         </div>
                       </div>
                       <div class="col-sm-3 is-editable"><span class="att_label">Organism</span> <span id="result_gc_id_{{:id}}_display_organism">{{:organism}}</span></div>
                       <div class="col-sm-3 editable-version">
                         <div class="form-group">
                           <label for="result_gc_id_{{:id}}_editable_organism_id">Organism</label>
                           <select class="form-control" id="result_gc_id_{{:id}}_editable_organism_id" data-original-val="{{:organism_id}}"></select>
                         </div>
                       </div>
                       
                       <div class="col-sm-3"><span class="att_label">Owner</span> {{:user_name}}</div>
                       <div class="col-sm-3"><span class="att_label">Added</span> {{:date_added}}</div>
                     </div>
                     <div class="row">
                       <div class="col-sm-3 pt-2">
                         <div class="pl-2">
                           {{if gctype == "weighted-list" }}
                              <button id="btn_gc_{{:id}}_preview" class="btn btn-default btn-sm btn-outline-secondary gc_weighted_gene_list_toggle" data-toggle="tooltip" data-gc-id="{{:id}}" data-gc-share-id="{{:share_id}}"
                                      data-placement="top" title="Show gene list"><i class="fa fa-list-ul"></i> Preview</button>
                              
                              <button id="btn_gc_{{:id}}_loading" class="btn btn-default btn-sm btn-outline-secondary shown_later" data-toggle="tooltip" data-gc-id="{{:id}}"
                                      data-placement="top" title="Loading">
                                  <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                  Loading
                              </button>

                              <button id="btn_gc_{{:id}}_hider" class="btn btn-default btn-sm btn-outline-secondary gc_weighted_gene_list_hider shown_later" data-toggle="tooltip" data-gc-id="{{:id}}"
                                      data-placement="top" title="Hide gene list"><i class="fa fa-eye-slash"></i> Hide</button>
                              
                           {{else}}
                              <button class="btn btn-default btn-sm btn-outline-secondary gc_unweighted_gene_list_toggle" data-toggle="tooltip" data-gc-id="{{:id}}"
                                      data-placement="top" title="Show gene list"><i class="fa fa-list-ul"></i> {{:gene_count}} genes</button>
                           {{/if}}
                         </div>
                       </div>
                       <div class="col-sm-6">
                         <div class="att_buttons btn-group pt-2" role="group">
                           <button class="btn btn-default btn-sm btn-outline-secondary view_gc" value="{{:share_id}}" data-toggle="tooltip" data-placement="bottom" title="View on front page"><i class="fa fa-eye"></i></button>
                           <button class="btn btn-default btn-sm btn-outline-danger delete_gc" value="{{:id}}" data-owner-id="{{:user_id}}" data-toggle="popover" data-placement="bottom" title="Remove cart"><i class="fa fa-trash"></i></button>
                           <button class="btn btn-default btn-sm btn-outline-secondary download_gc" data-gc-share-id="{{:share_id}}" data-gc-id="{{:id}}" data-toggle="popover" data-placement="bottom" title="Download cart"><i class="fa fa-download"></i></button>
                           <button class="btn btn-default btn-sm btn-outline-secondary share_gc" value="{{:share_id}}" data-gc-id="{{:id}}" data-toggle="popover" data-placement="bottom" title="Share cart"><i class="fa fa-share-alt"></i></button>
                           <button class="btn btn-default btn-sm btn-outline-secondary edit_gc is-editable" value="{{:gc_id}}" data-gc-id="{{:id}}" data-toggle="popover" data-placement="bottom" title="Edit cart"><i class="fa fa-pencil"></i></button>
                           <button class="btn btn-default btn-sm btn-outline-primary edit_gc_save editable-version" value="{{:id}}" data-gc-id="{{:id}}" data-toggle="popover" data-placement="bottom" title="Save edits"><i class="fa fa-floppy-o"></i> Save edits</button>
                           <button class="btn btn-default btn-sm btn-outline-primary edit_gc_cancel editable-version" value="{{:id}}" data-gc-id="{{:id}}" data-toggle="popover" data-placement="bottom" title="Cancel edits"><i class="fa fa-undo"></i> Cancel edits</button>
                         </div>
                       </div>
                       <div class="col-sm-3 pt-2 pl-0"><span class="att_label">Type</span> {{:gctype}}</div>
                     </div> <!-- end .row -->
                     <div class="row">
                       <div class="col-sm-3"></div>
                       <div class="col-sm-9 pl-4">
                         <span class="gc_action_note"></span>                         
                       </div>
                     </div> <!-- end .row -->
                     <div class="row">
                       <div class="col-sm-12 pl-4">
                         {{if gctype == "weighted-list" }}
                           <div class="weighted_gene_list_c" id="{{:id}}_gene_table"></div>
                           {{else}}
                              <ul class="gene_list shown_later" id="{{:id}}_gene_list">
                              {{for genes}}
                               <li class="mt-1">{{:}}</li>
                              {{/for}}
                              </ul> 
                           {{/if}}
                       </div>
                     </div> <!-- end .row -->
                   </div>
                   <hr class="gc_list_element_divider" />
                 </div> <!-- end .gc_list_element_c -->
              </script>
              <script id="weighted_gene_list_header_tmpl" type="text/x-jsrender">
                <td>{{:}}</td>
              </script>
            </div> <!-- gc_list_c -->
          </div> <!-- #view_controls -->
        </div> <!-- #main_panel -->
        
      </div>
    </div><!-- end #main_row -->
 </div> <!-- end #main_content -->

 <div id='account_creation_c' class='row'>
  <!-- content inserted via common.js-->
 </div>
 <div style="clear: both;">&nbsp;</div>
 <footer>
   <div id='funding'>
     <!-- content here inserted via JQuery -->
   </div>
 </footer>

        <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>

        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

        <script src="js/vendor/js.cookie.js"></script>
        <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/jsrender/1.0.11/jsrender.min.js"></script>-->
        <script src="js/vendor/jsrender.20181003.min.js"></script>

        <script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.4.0/js/bootstrap4-toggle.min.js"></script>

        <!-- Helps ensure the user gets the latest code, needed while we're pushing out so many updates -->
        <script>document.write('<script src="js/common.js?dev=' + Math.floor(Math.random() * 10000) + '"\><\/script>');</script>
        <script>document.write('<script src="js/classes/user.js?dev=' + Math.floor(Math.random() * 10000) + '"\><\/script>');</script>
        <script>document.write('<script src="js/classes/gene.js?dev=' + Math.floor(Math.random() * 10000) + '"\><\/script>');</script>
        <script>document.write('<script src="js/classes/genecart.js?dev=' + Math.floor(Math.random() * 10000) + '"\><\/script>');</script>
        <script>document.write('<script src="js/gene_cart_manager.js?dev=' + Math.floor(Math.random() * 10000) + '"\><\/script>');</script>
    </body>
</html>
